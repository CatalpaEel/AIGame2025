#è¿™ä¸ªé¡¹ç›®å®ç°æ ¹æ®æ´»åŠ¨ç­–åˆ’æ¡ˆç”Ÿæˆä¸€ä¸ªå¾®ä¿¡å…¬ä¼—å·æ¨é€ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨å¾®ä¿¡å…¬ä¼—å·ä¸Šå‘å¸ƒæ´»åŠ¨ä¿¡æ¯ã€‚

from openai import OpenAI
import json
import writer
from api_key import deepseek_api_key

deepseek_base_url = "https://api.deepseek.com"

class WOAPN_Designer:
    """
    Design WOA push notification based on ActivityDesigner using Deepseek API.
    """
    def __init__(self):
        pass # TODO
        self.client = OpenAI(api_key=deepseek_api_key, base_url=deepseek_base_url)
        self.system_prompt = """
        ä½ æ˜¯åŒ—äº¬å¤§å­¦ä¿¡æ¯ç§‘å­¦å­¦é™¢å­¦ç”Ÿä¼šçš„ä¸€åç»éªŒä¸°å¯Œçš„åŒå­¦ã€‚
        ä½ å°†è¦å¸®åŠ©ç”¨æˆ·è§£æå‡ºæ´»åŠ¨çš„æ˜¾æ€§ä¿¡æ¯ï¼ˆæ´»åŠ¨ç±»å‹ã€ä¸»é¢˜æ–¹å‘ã€åˆæ­¥æ„æƒ³ç­‰ï¼‰ï¼Œå¹¶é€šè¿‡æ¨ç†è¡¥å…¨éšæ€§ä¿¡æ¯ï¼ˆéšæ€§ä¿¡æ¯ï¼šç›®æ ‡å—ä¼—ã€æ´»åŠ¨è§„æ¨¡ã€æ—¶é—´å®‰æ’ã€å¯èƒ½çš„åˆä½œæ–¹ç­‰ï¼‰ã€‚
        ç³»ç»Ÿåº”è‡ªä¸»åˆ¤æ–­å¹¶è¡¥å…¨ä¿¡æ¯ç¼ºå¤±é¡¹ï¼Œæ— éœ€ç”¨æˆ·é¢å¤–è¾“å…¥ã€‚ 
        è¾“å…¥ä¸ºä¹‹å‰ç”Ÿæˆçš„æ´»åŠ¨ç­–åˆ’æ¡ˆï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
        {
            å¦‚æœæ˜¯ç«èµ›ç±»æ´»åŠ¨ç­–åˆ’æ¡ˆï¼Œåˆ™æŒ‰ç…§ä»¥ä¸‹çš„è¦æ±‚ï¼š
            {    "type": "æ¯”èµ›",
                "subject": "äººå·¥æ™ºèƒ½åº”ç”¨åˆ›æ–°å¤§èµ›",
                "schedule": {
                "competition question design": [
                    "åˆèµ›ï¼šåŸºäºå…¬å¼€æ•°æ®é›†çš„å›¾åƒåˆ†ç±»æ¨¡å‹ä¼˜åŒ–ï¼ˆé™æ—¶72å°æ—¶ï¼‰",
                    "å¤èµ›ï¼šå¤šæ¨¡æ€æ•°æ®èåˆçš„æ™ºèƒ½å®¢æœç³»ç»Ÿè®¾è®¡ï¼ˆæäº¤æŠ€æœ¯æ–¹æ¡ˆä¸åŸå‹æ¼”ç¤ºï¼‰",
                    "å†³èµ›ï¼šç°åœºå‘½é¢˜å¼€å‘ï¼ˆæ™ºæ…§æ ¡å›­åœºæ™¯åº”ç”¨å¼€å‘ï¼Œ8å°æ—¶é™æ—¶ç¼–ç¨‹ï¼‰"
                ],
                "grading criteria": {
                    "æŠ€æœ¯åˆ›æ–°æ€§": 30,
                    "åŠŸèƒ½å®Œæ•´æ€§": 25,
                    "ä»£ç è§„èŒƒæ€§": 20,
                    "å•†ä¸šä»·å€¼": 15,
                    "ç°åœºç­”è¾©": 10
                },
                "activity process": [
                    "09:00-09:30 å¼€å¹•å¼ï¼ˆé™¢å£«è‡´è¾ï¼‰",
                    "09:30-12:00 åˆèµ›ä½œå“æäº¤",
                    "14:00-17:00 å¤èµ›æ–¹æ¡ˆå±•ç¤º",
                    "æ¬¡æ—¥09:00-17:00 å†³èµ›å¼€å‘ä¸è¯„å®¡"
                ]
                },
                "objective": "åŸ¹å…»AIå·¥ç¨‹å®è·µèƒ½åŠ›ï¼Œæ¨åŠ¨äº§å­¦ç ”åˆä½œ",
                "scale": 200,
                "time": "2023å¹´11æœˆ15æ—¥-11æœˆ17æ—¥",
                "place": "åŒ—äº¬å¤§å­¦ç‹å…‹æ¡¢æ¥¼æ™ºèƒ½å®éªŒå®¤",
                "cooperation": [
                    "ç™¾åº¦AIå®éªŒå®¤",
                    "ä¸­å›½äººå·¥æ™ºèƒ½å­¦ä¼š",
                    "åŒ—äº¬å¤§å­¦å­¦ç”Ÿç§‘å"
                ],
                "resourves requriment": [
                    "GPUæœåŠ¡å™¨é›†ç¾¤",
                    "æ•°æ®é›†å­˜å‚¨è®¾å¤‡",
                    "è¯„å§”ä¸“å®¶5äºº",
                    "å­¦ç”Ÿå¿—æ„¿è€…20äºº"
                ],
                "propaganda strategy": {
                "online": [
                    "å¾®ä¿¡å°ç¨‹åºæŠ¥åç³»ç»Ÿ",
                    "Bç«™æŠ€æœ¯é¢„çƒ­ç›´æ’­ï¼ˆ3åœºï¼‰",
                    "çŸ¥ä¹ä¸“é¢˜è®¨è®ºåŒº"
                ],
                "offline": [
                    "ä¸‰è§’åœ°æ¡æ¶æµ·æŠ¥ï¼ˆä¸»è§†è§‰ï¼šç¥ç»å…ƒç½‘ç»œä¸ç‡•å›­å»ºç­‘èåˆï¼‰",
                    "æ•™å­¦æ¥¼ç”µå­å±è½®æ’­ï¼ˆåŒ…å«å¾€å±Šä¼˜ç§€ä½œå“å±•ç¤ºï¼‰"
                ]
                },
                "visual design": {
                    "æµ·æŠ¥æ–‡æ¡ˆ": "ã€Œæ™ºæ±‡ç‡•å›­ã€ç¬¬ä¸‰å±ŠAIåˆ›æ–°æŒ‘æˆ˜èµ›",
                    "æµç¨‹å›¾": "æŠ¥åâ†’çº¿ä¸ŠåŸ¹è®­â†’åˆèµ›â†’å¤èµ›â†’å†³èµ›â†’é¢å¥–å…¸ç¤¼",
                    "å®£ä¼ è§†é¢‘": "30ç§’å¿«å‰ªï¼ˆå¾€å±Šé€‰æ‰‹è®¿è°ˆ+æŠ€æœ¯åº”ç”¨åœºæ™¯æ¨¡æ‹Ÿï¼‰"
                }
            }

            å¦‚æœæ˜¯éç«èµ›ç±»æ´»åŠ¨ç­–åˆ’æ¡ˆ: {
                "type": "å­¦æœ¯è®²åº§",
                "subject": "åŒºå—é“¾æŠ€æœ¯å‰æ²¿ä¸åº”ç”¨å®è·µ",
                "schedule": {
                "lecture content": [
                    "14:00-14:10 ä¸»æŒäººå¼€åœº",
                    "14:10-15:30 ä¸»æ—¨æ¼”è®²ï¼ˆå¤®è¡Œæ•°å­—è´§å¸ç ”ç©¶æ‰€ä¸“å®¶ï¼‰",
                    "15:30-16:00 æ¡ˆä¾‹å·¥ä½œåŠï¼ˆåˆ†ç»„æ¨¡æ‹Ÿæ™ºèƒ½åˆçº¦å¼€å‘ï¼‰",
                    "16:00-16:30 äº’åŠ¨é—®ç­”ï¼ˆçº¿ä¸Šçº¿ä¸‹åŒæ­¥è¿›è¡Œï¼‰"
                ]
                },
                "objective": "æ™®åŠåŒºå—é“¾æ ¸å¿ƒæŠ€æœ¯ï¼Œæ¢è®¨æ•°å­—ç»æµæ–°åŸºå»º",
                "scale": 150,
                "time": "2023å¹´10æœˆ25æ—¥ 14:00-17:00",
                "place": "äºŒæ•™301æ™ºæ…§æ•™å®¤",
                "cooperation": [
                    "å¾®ä¼—é“¶è¡ŒåŒºå—é“¾äº‹ä¸šéƒ¨",
                    "åŒ—äº¬å¤§å­¦é‡‘èç§‘æŠ€ç ”ç©¶é™¢"
                ],
                "resources requriment": [
                    "åŒºå—é“¾æ²™ç›’å®éªŒå¹³å°",
                    "å¤šæœºä½ç›´æ’­è®¾å¤‡",
                    "åŒå£°ä¼ è¯‘ç³»ç»Ÿ",
                    "èŒ¶æ­‡ç‰©èµ„ï¼ˆ50äººä»½ï¼‰"
                ],
                "propaganda strategy": {
                "å®šå‘é‚€è¯·": [
                    "è®¡ç®—æœºå­¦é™¢ã€å…‰åç®¡ç†å­¦é™¢ç ”ç©¶ç”Ÿ",
                    "é‡‘èç§‘æŠ€ç¤¾å›¢æˆå‘˜"
                ],
                "public spread": [
                    "æœªåBBSç½®é¡¶å¸–ï¼ˆå«é¢„ä¹ èµ„æ–™åŒ…ï¼‰",
                    "å­¦ä¹ é€šå¹³å°åŒæ­¥ç›´æ’­"
                ]
                },
                "visual design": {
                    "æµ·æŠ¥ä¸»è§†è§‰": "ç«‹ä½“åŒ–çš„åŒºå—é“¾èŠ‚ç‚¹ä¸æœªåæ¹–å€’å½±",
                    "äº’åŠ¨ç¯èŠ‚": "ç°åœºç”ŸæˆNFTæ•°å­—çºªå¿µè¯ä¹¦",
                    "å®£ä¼ äº®ç‚¹": "ä¼šåå»ºç«‹æŒç»­äº¤æµçš„å­¦æœ¯ç¤¾ç¾¤"
                }
                }
            }
        }
        è¾“å‡ºä¸ºè§£æåçš„æ´»åŠ¨ä¿¡æ¯ï¼Œè¦æ±‚è¾“å‡ºä¸ºå¾®ä¿¡å…¬ä¼—å·æ¨é€æ–‡ï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
        {
            
                        {
                "wechat_public_post": {
                    "title": "ğŸ‰ã€åŒ—å¤§AIå·…å³°æˆ˜ã€‘72å°æ—¶å¼€å‘ç‹‚æ¬¢ï¼ç™¾åº¦/é˜¿é‡Œäº‘èµ„æºä»»ä½ ç”¨",
                    "cover_image": "åŠ¨æ€èµ›åšé£æµ·æŠ¥ï¼ˆæ‰«ç è§¦å‘ARå®éªŒå®¤é¢„è§ˆï¼‰",
                    
                    "content": [
                        "ğŸŒŸ **æ ¸å¿ƒäº®ç‚¹**",
                        "â–«ï¸ é™¢å£«çº§è¯„å§”å›¢ï¼š5ä½IEEE Fellowåé•‡æŒ‡å¯¼",
                        "â–«ï¸ çœŸå®äº§ä¸šå‘½é¢˜ï¼šç™¾åº¦æ™ºæ…§åŸå¸‚é¡¹ç›®éœ€æ±‚æ‹†è§£",
                        "â–«ï¸ ç™¾ä¸‡çº§ç®—åŠ›æ± ï¼šNVIDIA V100é›†ç¾¤+é˜¿é‡Œäº‘å¼¹æ€§èµ„æº",
                        
                        "ğŸš¨ **æé™èµ›ç¨‹**",
                        "```",
                        "11.15 09:00  åˆèµ›å¯åŠ¨ï¼ˆImageNetä¼˜åŒ–å†²åˆºï¼‰",
                        "11.16 14:00  å¤èµ›demoæ—¥ï¼ˆè¯­éŸ³+æ–‡æœ¬å¤šæ¨¡æ€èåˆï¼‰", 
                        "11.17 09:00  æœ€ç»ˆå†³æˆ˜ï¼ˆæ™ºæ…§æ ¡å›­åœºæ™¯8å°æ—¶ç¼–ç¨‹ï¼‰",
                        "```",
                        
                        "ğŸ’ **å‚èµ›å³å¾—**",
                        "- ç™¾åº¦AIGCéƒ¨é—¨ç›´é€šç»ˆé¢å¡ï¼ˆå‰30åï¼‰",
                        "- ã€ŠPyTorchå·¥ç¨‹åŒ–æŒ‡å—ã€‹å®ä½“æ‰‹å†Œ", 
                        "- å¯å…‘æ¢ç¬¬äºŒè¯¾å ‚åˆ›æ–°å­¦åˆ†",
                        
                        "ğŸ **éšè—ç¦åˆ©**",
                        "> è½¬å‘æœ¬æ–‡è‡³æœ‹å‹åœˆ â†’ æŠ½3äººé€Jetson Nanoå¥—ä»¶",
                        "> ç»„é˜Ÿå‚èµ›é˜Ÿä¼ â†’ é¢å¤–è·èµ 100å…ƒäº‘æœåŠ¡åˆ¸",
                        
                        "ğŸ“Œ **æŠ€æœ¯æŒ‡å—**",
                        "â—ï¸ å¼€å‘ç¯å¢ƒï¼šLinuxç³»ç»Ÿï¼ˆæ¨èUbuntu 20.04ï¼‰",
                        "â—ï¸ æ•°æ®è§„èŒƒï¼šé™ç”¨MSCOCO/ImageNetå…¬å¼€æ•°æ®é›†",
                        "â—ï¸ ä»£ç å®¡æŸ¥ï¼šGitHubä»“åº“éœ€åŒ…å«å®Œæ•´commitè®°å½•",
                        
                        "ğŸ‘‡ **æŠ¥åé€šé“**",
                        "å¾®ä¿¡æ‰«ç  â†’ å¡«å†™ç»„é˜Ÿä¿¡æ¯ â†’ æäº¤GitHubå¾€æœŸé¡¹ç›®",
                        "ï¼ˆåŠ¨æ€ç”Ÿæˆå›¢é˜Ÿä¸“å±æŠ¥åäºŒç»´ç ï¼‰"
                    ],
                    
                    "interactive_elements": {
                        "è§†é¢‘åµŒå…¥": "Bç«™AV12345678ï¼ˆå¾€å±Šå† å†›ä»£ç å¤ç›˜ï¼‰", 
                        "æŠ•ç¥¨ç»„ä»¶": "ã€Œæœ€æœŸå¾…æŠ€æœ¯ç¯èŠ‚ã€äººæ°”PKï¼ˆé€åä¸ºäº‘ä»£é‡‘åˆ¸ï¼‰",
                        "åœ°å›¾å¯¼èˆª": "ç‹å…‹æ¡¢æ¥¼æ™ºèƒ½å®éªŒå®¤3Då¯¼è§ˆ"
                    },
                    
                    "tech_features": [
                        "åŒºå—é“¾å­˜è¯ï¼šæ‰€æœ‰è¯„åˆ†è®°å½•ä¸Šé“¾å¯è¿½æº¯",
                        "äº‘ç«¯æ²™ç›’ï¼šç™¾åº¦AI Studioåœ¨çº¿å¼€å‘ç¯å¢ƒ", 
                        "æ™ºèƒ½ç»„é˜Ÿï¼šH5é¡µé¢è‡ªåŠ¨åŒ¹é…æŠ€æœ¯äº’è¡¥é˜Ÿå‹"
                    ],
                    
                    "contact": {
                        "å’¨è¯¢ç¾¤": "å¾®ä¿¡æ‰«ç æ·»åŠ å°åŠ©æ‰‹ï¼ˆå›å¤ã€Œç»„é˜Ÿã€è‡ªåŠ¨åŒ¹é…ï¼‰",
                        "ç´§æ€¥è”ç»œ": "æŠ€æœ¯æ”¯æŒ188-1234-5678ï¼ˆ24å°æ—¶æé€Ÿå“åº”ï¼‰",
                        "é‚®ç®±æŠ¥éšœ": "ai_competition@pku.edu.cn"
                    }
                }
            }
     }
                
                
                """
        
    def design_WOANP(self, input_text):
         response = self.client.chat.completions.create(
            model = "deepseek-chat",
            messages = [
                {"role": "system", "content": self.system_prompt},
                {"role": "user", "content": input_text},
            ],
            stream = False
        )
         return response.choices[0].message.content

class WOAPNWriter:
    """
    Write WOA push notification based on user input and reference data using Deepseek API.
    """
    def __init__(self):
        pass # TODO


if __name__ == "__main__":
    
    input_agent = WOAPN_Designer()
    #è°ƒç”¨æ´»åŠ¨ç­–åˆ’æ¡ˆçš„ç±»æ¥ç”Ÿæˆå¾®ä¿¡å…¬ä¼—å·çš„æ¨æ–‡
    activity_result=writer.ActivityDesigner()
    input_text =activity_result.design_activity( "{'type': 'æ¯”èµ›', 'subject': 'AIä¸å¤§æ¨¡å‹', 'schedule': 'ç»™å®šæ•°æ®é›†å’ŒåŸºæœ¬çš„ä»£ç ï¼Œè®©é€‰æ‰‹è°ƒå‚', 'objective': 'ç³»ç»Ÿæ€§è§£æå¤§æ¨¡å‹æŠ€æœ¯æ¼”è¿›è„‰ç»œï¼Œæ¢è®¨è‡ªç„¶è¯­è¨€å¤„ç†ã€å¤šæ¨¡æ€å­¦ä¹ ç­‰é¢†åŸŸçš„æœ€æ–°çªç ´ï¼›æ„å»ºå¼€æ”¾äº¤æµåœºåŸŸï¼Œä¿ƒè¿›å­¦æœ¯ç•Œä¸äº§ä¸šç•Œåœ¨ç®—åŠ›ä¼˜åŒ–ã€æ•°æ®æ²»ç†ã€ä¼¦ç†è§„èŒƒç­‰å…³é”®è®®é¢˜ä¸Šçš„ååŒåˆ›æ–°ï¼›æ¿€å‘é’å¹´å­¦å­æŠ€æœ¯çƒ­å¿±ï¼Œé€šè¿‡æ¡ˆä¾‹å‰–æä¸å®æˆ˜å·¥ä½œåŠåŸ¹å…»å¤åˆå‹AIäººæ‰ï¼ŒåŠ©åŠ›å›½å®¶äººå·¥æ™ºèƒ½æˆ˜ç•¥ä¸äº¤å‰å­¦ç§‘åˆ›æ–°å‘å±•', 'scale': 'å¾…å®š', 'time': '4æœˆä¸‹æ—¬ï¼šå¤§æ¨¡å‹è®­ç»ƒæŒ‘æˆ˜èµ›é¢„çƒ­æ¨é€&æŠ¥åæ¨é€ï¼Œ5æœˆä¸­æ—¬ï¼šå¤§æ¨¡å‹è®­ç»ƒæŒ‘æˆ˜èµ›æ€»ç»“æ¨é€', 'place': 'åŒ—äº¬å¤§å­¦ä¿¡æ¯ç§‘å­¦æŠ€æœ¯å­¦é™¢', 'cooperation': 'Linuxç¤¾'}")
    
    analysis_result = input_agent.design_WOANP(input_text)
    print(analysis_result)

    # TODO

    # æ•°æ®ä»reference.jsonæ–‡ä»¶é‡Œé¢è¯»ï¼Œåè°ƒå¥½æ ¼å¼

